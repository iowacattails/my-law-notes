<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Law Note Publisher</title>
<style>
body{background:#ff0;padding:20px;font-family:Georgia;font-size:1.3em;}
h1{font-size:2.5em;text-align:center;}
input,textarea,button{width:100%;padding:15px;margin:10px 0;}
button{background:#000;color:#ff0;border:none;padding:25px;font-weight:bold;cursor:pointer;}
.tag-btn{display:inline-block;background:#fff;color:#000;padding:10px 20px;margin:8px;border:3px solid #000;cursor:pointer;}
.tag-btn.selected{background:#000;color:#ff0;}
#preview{background:#fff;padding:40px;margin-top:50px;border:4px solid #000;}
</style>
</head>
<body>
<h1>Law Note Publisher</h1>
<input type="text" id="title" placeholder="Page Title">
<textarea rows="10" id="note" placeholder="Your note"></textarea>
<input type="text" id="image" placeholder="Image URL">
<div style="margin:50px 0;">
<strong>Tags:</strong><br>
<span class="tag-btn" onclick="toggle(this)">Common Law</span>
<span class="tag-btn" onclick="toggle(this)">Trial by Jury</span>
<span class="tag-btn" onclick="toggle(this)">Vicinage</span>
<input type="text" placeholder="Custom tag + Enter" onkeydown="if(event.key==='Enter')addCustom(this)">
<div id="tags">Tags: none</div>
</div>
<button onclick="publishImageFirst()">PUBLISH IMAGE FIRST</button>
<button onclick="publishPage()">PUBLISH PAGE</button>
<a href="image-uploader.html" style="font-size:1.5em;color:#000;display:block;margin:40px;">Upload Image First</a>
<div id="preview"><h2>Live Preview</h2><div id="previewContent">Start typing...</div></div>
<script>
let tags=[];
function toggle(el){const t=el.textContent.trim();if(tags.includes(t))tags=tags.filter(x=>x!==t),el.classList.remove('selected');else tags.push(t),el.classList.add('selected');document.getElementById('tags').textContent='Tags: '+tags.join(', ')||'none';updatePreview()}
function addCustom(i){const t=i.value.trim();if(t)tags.push(t),i.value='';document.getElementById('tags').textContent='Tags: '+tags.join(', ')||'none';updatePreview()}
const params=new URLSearchParams(location.search);
if(params.get('img')) document.getElementById('image').value=params.get('img');
function updatePreview(){const title=document.getElementById('title').value||'Untitled';let html=`<h1>${title}</h1><p>`;html+=document.getElementById('note').value.replace(/\n/g,'<br><br>');const img=document.getElementById('image').value;if(img) html+=`<div style="text-align:center"><img src="${img}" style="max-width:50%;"></div><br>`;html+=`<em>Tags: ${tags.join(', ')||'none'}</em><br><a href="index.html" style="background:#fff;color:#000;padding:30px;display:block;border:4px solid #000;">← Return to Law Book Links</a>`;document.getElementById('previewContent').innerHTML=html}
function publishImageFirst(){const url=document.getElementById('image').value.trim();if(!url) return alert("No image URL!");const filename=url.split('/').pop();window.open(`https://github.com/iowacattails/my-law-notes/upload/main/images?filename=${filename}`,'_blank');alert("Image tab opened — commit it first!")}
function publishPage(){const title=document.getElementById('title').value.trim()|| "Untitled";const slug=title.toLowerCase().replace(/[^a-z0-9]+/g,'-')+'.html';const html=buildHTML(title);window.open(`https://github.com/iowacattails/my-law-notes/new/main?filename=${slug}&value=${encodeURIComponent(html)}`,'_blank')}
function buildHTML(title){let html=`<!DOCTYPE html><html><head><meta charset="UTF-8"><title>${title}</title><style>body{background:#ff0;margin:40px;font-family:Georgia;font-size:2.2em;line-height:2.1;}img{max-width:50%;margin:60px auto;display:block;border:4px solid #000;}</style></head><body><h1>${title}</h1><p>`;html+=document.getElementById('note').value.replace(/\n/g,'<br><br>');const img=document.getElementById('image').value.trim();if(img) html+=`<div style="text-align:center"><img src="${img}"></div><br>`;html+=`<em>Tags: ${tags.join(', ')||'none'}</em><br><a href="index.html" style="background:#fff;color:#000;padding:30px;display:block;border:4px solid #000;">← Return to Law Book Links</a></body></html>`;return html}
updatePreview();
</script>
</body>
</html>
